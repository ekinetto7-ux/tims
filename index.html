<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ãƒˆãƒ¬ã‚¤ãƒ³ãƒ‘ãƒ¼ã‚¯DX</title>
<style>
body { font-family: sans-serif; background:#eef2f5; text-align:center; }
button { padding:10px 20px; margin:6px; border-radius:20px; border:none; background:#2196f3; color:white; font-size:15px; }
.box { background:white; margin:15px auto; padding:15px; width:90%; max-width:420px; border-radius:12px; }
.hidden { display:none; }
</style>
</head>
<body>

<!-- ã‚¿ã‚¤ãƒˆãƒ« -->
<div id="title" class="box">
  <h1>ğŸš† ãƒˆãƒ¬ã‚¤ãƒ³ãƒ‘ãƒ¼ã‚¯DX</h1>
  <button onclick="start()">é–‹å§‹</button>
</div>

<!-- ãƒ›ãƒ¼ãƒ  -->
<div id="home" class="box hidden">
  <p>ğŸ« ãƒã‚±ãƒƒãƒˆï¼š<span id="ticket"></span></p>
  <button onclick="openGacha()">ã‚¬ãƒãƒ£</button>
  <button onclick="garage()">è»Šåº«</button>
  <button onclick="shop()">ã‚·ãƒ§ãƒƒãƒ—</button>
  <button onclick="map()">ãƒãƒƒãƒ—</button>
  <p id="msg"></p>
</div>

<script>
/* ===== ä¿å­˜ ===== */
let data = JSON.parse(localStorage.getItem("TPDX")) || {
  ticket: 10000,
  trains: [],
  firstGacha: true
};

const rangeByStar = {1:3500,2:3800,3:4000,4:5000,5:10000};

const trainsDB = [
  {name:"209ç³» å†…æˆ¿ç·š", star:1},
  {name:"E233ç³»", star:2},
  {name:"185ç³» è¸Šã‚Šå­ æ¹˜å—è‰²", star:3},
  {name:"E353ç³»", star:4},
  {name:"N700S æ–°å¹¹ç·š", star:5}
];

function save(){ localStorage.setItem("TPDX",JSON.stringify(data)); }
function update(){ document.getElementById("ticket").textContent=data.ticket; save(); }

/* ===== èµ·å‹• ===== */
function start(){
  document.getElementById("title").classList.add("hidden");
  document.getElementById("home").classList.remove("hidden");
  update();
}

/* ===== ã‚¬ãƒãƒ£ ===== */
function openGacha(){
  const c = prompt("1:å˜ç™º(2000)\n2:11é€£(20000)");
  if(c==="1") pull(1);
  if(c==="2") pull(11);
}

function pull(times){
  let cost = times===11?20000:2000;
  if(data.ticket<cost){alert("ãƒã‚±ãƒƒãƒˆä¸è¶³");return;}
  data.ticket-=cost;

  let result="";
  for(let i=0;i<times;i++){
    let star = rollStar();
    let pool = trainsDB.filter(t=>t.star===star);
    let t = pool[Math.floor(Math.random()*pool.length)];
    data.trains.push({name:t.name,star:star,range:rangeByStar[star]});
    result+=`${t.name} â­${star}\n`;
  }
  document.getElementById("msg").textContent=result;
  data.firstGacha=false;
  update();
}

function rollStar(){
  let r=Math.random()*100;
  if(data.firstGacha && Math.random()<0.3) return 1;
  if(r<0.1) return 5;
  if(r<3) return 4;
  if(r<10) return 3;
  if(r<20) return 2;
  return 1;
}

/* ===== è»Šåº« ===== */
function garage(){
  if(data.trains.length===0){alert("è»Šä¸¡ãªã—");return;}
  let t="ã€è»Šåº«ã€‘\n";
  data.trains.forEach((v,i)=>{
    t+=`${i+1}. ${v.name} â­${v.star} è·é›¢:${v.range}\n`;
  });
  alert(t);
}

/* ===== ã‚·ãƒ§ãƒƒãƒ— ===== */
function shop(){
  let c=prompt("1:èµ°è¡Œè·é›¢å›å¾©(500)\n2:2å€+å›å¾©(1000)");
  if(c==="1"&&data.ticket>=500){
    data.ticket-=500;
    data.trains.forEach(t=>t.range=rangeByStar[t.star]);
    alert("å›å¾©å®Œäº†");
  }
  else if(c==="2"&&data.ticket>=1000){
    data.ticket-=1000;
    data.trains.forEach(t=>t.range=rangeByStar[t.star]);
    alert("æ¬¡å›2å€ï¼ˆä»®ï¼‰");
  }
  update();
}

/* ===== ãƒãƒƒãƒ— ===== */
function map(){
  alert(
`ãƒãƒƒãƒ—é¸æŠ
1 è’ã‚ŒãŸæ£®æ—åœ°å¸¯
2 æµ·ã®ç ‚æµœ
3 æ²³å·æ•·
4 å¤§è¦æ¨¡éƒ½å¸‚
5 è¿‘æœªæ¥éƒ½å¸‚`
  );
}
</script>
</body>
</html>
