<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>é‹è»¢å°</title>
<style>
  body { background:#000; color:#fff; font-family: system-ui, -apple-system, sans-serif; }
  .top { display:flex; justify-content:space-between; align-items:center; padding:8px 12px; font-size:18px; }
  .role { opacity:.9 }
  .state { color:#ff3b3b; font-weight:700 }

  .panel { padding:12px }
  .next { font-size:22px; margin:8px 0 }
  .next .label { color:#ffd400; margin-right:6px }

  .stations { display:flex; gap:14px; font-size:18px }
  .stations span { color:#fff }

  .controls { display:flex; gap:12px; margin-top:16px }
  button {
    font-size:20px; padding:14px 18px; border-radius:10px; border:none;
    background:#222; color:#fff;
  }
  button:active { transform:scale(.98) }
  .emg { background:#b00020; }

  .overlay {
    position:fixed; inset:0; background:rgba(0,0,0,.75);
    display:none; align-items:center; justify-content:center;
  }
  .emgBox {
    background:#111; border:2px solid #b00020; border-radius:12px;
    padding:16px; width:min(92vw,420px);
  }
  .emgTitle { color:#ff3b3b; font-size:22px; margin-bottom:10px; }
  .emgBtns { display:grid; grid-template-columns:1fr 1fr; gap:10px; }
  .emgBtns button { background:#2a0000 }

  .emgText {
    margin-top:12px; color:#ff3b3b; font-size:20px; font-weight:700;
    white-space:pre-line;
  }
</style>
</head>
<body>

<div class="top">
  <div class="role">ğŸ‘¨â€âœˆï¸ é‹è»¢å£«</div>
  <div id="trainState" class="state">èµ°è¡Œä¸­</div>
  <div class="role">ğŸšª è»ŠæŒ</div>
</div>

<div class="panel">
  <div class="next">
    <span class="label">æ¬¡</span>
    <span id="nextStation">æœ¨æ›´æ´¥</span>
  </div>

  <div class="stations" id="stationRow"></div>

  <div class="controls">
    <button id="nextBtn">æ¬¡é§…</button>
    <button id="emgBtn" class="emg">éå¸¸</button>
  </div>

  <div id="emgMessage" class="emgText" style="display:none;"></div>
</div>

<div id="overlay" class="overlay">
  <div class="emgBox">
    <div class="emgTitle">éå¸¸ç†ç”±ã‚’é¸æŠ</div>
    <div class="emgBtns">
      <button data-reason="åœ°éœ‡ç™ºç”Ÿã€‚\nç›´ã¡ã«é«˜å°ã¸é¿é›£ã€‚\nè»ŠæŒã¨é€£æºã€‚">åœ°éœ‡</button>
      <button data-reason="ç«ç½ç™ºç”Ÿã€‚\nãƒ‰ã‚¢ã¯é–‰ã‚ã‚‹ã€‚\nã™ã¹ã¦ã®çª“ã‚’é–‰ã‚ã‚‹ã“ã¨ã€‚\nãƒˆãƒ³ãƒãƒ«å†…åœè»Šã‚’é¿ã‘ã‚‹ã“ã¨ã€‚">ç«ç½</button>
      <button data-reason="äººèº«äº‹æ•…ç™ºç”Ÿã€‚\nãŸã ã¡ã«æœ€å¯„ã‚Šã®é‹è»¢å£«ãƒ»è»ŠæŒãƒ»æŒ‡ä»¤ã¸é€£çµ¡ã€‚\nè­¦å¯Ÿãƒ»æ¶ˆé˜²ã¸é€£çµ¡ã™ã‚‹ã“ã¨ã€‚">äººèº«äº‹æ•…</button>
    </div>
  </div>
</div>

<script>
  const stations = [
    "å›æ´¥","æœ¨æ›´æ´¥","è¢–ãƒ¶æµ¦","é•·æµ¦","å§‰ãƒ¶å´","äº”äº•",
    "å…«å¹¡å®¿","æµœé‡","è˜‡æˆ‘","æœ¬åƒè‘‰","åƒè‘‰","æ´¥ç”°æ²¼",
    "èˆ¹æ©‹","å¸‚å·","æ–°å°å²©","é¦¬å–°ç”º","éŒ¦ç³¸ç”º","æ–°æ—¥æœ¬æ©‹","æ±äº¬"
  ];

  let idx = 1;
  let emergency = false;

  const nextStationEl = document.getElementById("nextStation");
  const rowEl = document.getElementById("stationRow");
  const stateEl = document.getElementById("trainState");
  const nextBtn = document.getElementById("nextBtn");
  const emgBtn  = document.getElementById("emgBtn");
  const overlay = document.getElementById("overlay");
  const emgMsg  = document.getElementById("emgMessage");

  function renderStations() {
    rowEl.innerHTML = "";
    for (let i = idx; i < Math.min(idx+3, stations.length); i++) {
      const s = document.createElement("span");
      s.textContent = stations[i];
      rowEl.appendChild(s);
    }
  }

  function renderNext() {
    nextStationEl.textContent = stations[idx] ?? "â€”";
  }

  function setEmergency(on, message="") {
    emergency = on;
    if (on) {
      stateEl.textContent = "éå¸¸åœæ­¢ä¸­";
      nextBtn.disabled = true;
      emgMsg.textContent = message;
      emgMsg.style.display = "block";
    } else {
      stateEl.textContent = "èµ°è¡Œä¸­";
      nextBtn.disabled = false;
      emgMsg.style.display = "none";
    }
  }

  nextBtn.onclick = () => {
    if (emergency) return;
    if (idx < stations.length - 1) {
      idx++;
      renderNext();
      renderStations();
    }
  };

  emgBtn.onclick = () => {
    if (!emergency) {
      overlay.style.display = "flex";
    } else {
      setEmergency(false);
    }
  };

  overlay.onclick = (e) => {
    if (e.target === overlay) overlay.style.display = "none";
  };

  document.querySelectorAll(".emgBtns button").forEach(btn=>{
    btn.onclick = () => {
      overlay.style.display = "none";
      setEmergency(true, btn.dataset.reason);
    };
  });

  renderNext();
  renderStations();
</script>
</body>
</html>
