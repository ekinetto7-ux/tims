<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Train Vision Control Panel</title>
<link rel="stylesheet" href="style.css">
<style>
/* UI専用追加CSS */
#ui-wrapper{
    width:95%;
    max-width:1200px;
    margin-top:20px;
    background:#050505;
    border-radius:15px;
    padding:15px;
    border:2px solid #333;
}

.ui-section{
    background:#0a0a0a;
    border-radius:12px;
    padding:12px;
    margin-bottom:12px;
}

.ui-section h3{
    margin-bottom:10px;
    color:#00ffcc;
}

.ui-row{
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    align-items:center;
}

.ui-row label{
    min-width:120px;
    font-size:14px;
}

.ui-row input,
.ui-row select,
.ui-row button{
    padding:6px 10px;
    border-radius:6px;
    border:none;
}

.ui-row button{
    background:#00aa88;
    font-weight:bold;
    cursor:pointer;
}

.ui-row button:hover{
    background:#00ffcc;
}

</style>
</head>

<body>

<div id="ui-wrapper">

    <!-- ===== 駅進行制御 ===== -->
    <div class="ui-section">
        <h3>駅進行制御</h3>
        <div class="ui-row">
            <button onclick="TrainAPI.stop()">停車</button>
            <button onclick="TrainAPI.depart()">発車</button>
            <button onclick="TrainAPI.prev()">前駅</button>
            <button onclick="TrainAPI.next()">次駅</button>
        </div>
    </div>

    <!-- ===== ナンバリング色 ===== -->
    <div class="ui-section">
        <h3>ナンバリング色設定</h3>
        <div class="ui-row">
            <label>駅選択</label>
            <select id="station-select"></select>

            <label>色</label>
            <input type="color" id="number-color">

            <button onclick="applyNumberColor()">反映</button>
        </div>
    </div>

    <!-- ===== 表示制御 ===== -->
    <div class="ui-section">
        <h3>表示制御</h3>
        <div class="ui-row">
            <button onclick="toggleLang('jp')">日本語</button>
            <button onclick="toggleLang('hira')">ひらがな</button>
            <button onclick="toggleLang('en')">英語</button>
            <button onclick="toggleLang('all')">全表示</button>
        </div>
    </div>

    <!-- ===== システム ===== -->
    <div class="ui-section">
        <h3>システム</h3>
        <div class="ui-row">
            <button onclick="resetSystem()">リセット</button>
        </div>
    </div>

</div>

<script src="main.js"></script>

<script>
/* ===== UI制御JS ===== */

function loadStationsToUI(){
    const select = document.getElementById("station-select");
    select.innerHTML = "";

    TrainAPI.config.stations.forEach((st, i)=>{
        const opt = document.createElement("option");
        opt.value = i;
        opt.innerText = st.jp;
        select.appendChild(opt);
    });
}

function applyNumberColor(){
    const index = document.getElementById("station-select").value;
    const color = document.getElementById("number-color").value;

    TrainAPI.config.stations[index].numberColor = color;

    // 保存
    localStorage.setItem("tv-config", JSON.stringify(TrainAPI.config.stations));

    syncMain();
}

function toggleLang(mode){
    localStorage.setItem("tv-lang", mode);
    syncMain();
}

function resetSystem(){
    localStorage.clear();
    location.reload();
}

/* ===== メイン画面同期 ===== */
function syncMain(){
    localStorage.setItem("tv-sync", Date.now());
}

/* 初期化待ち */
setTimeout(()=>{
    if(window.TrainAPI){
        loadStationsToUI();
    }
},500);
</script>

</body>
</html>
